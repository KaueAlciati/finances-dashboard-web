<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FinControl ‚Äî Dashboard</title>
  <meta name="description" content="Resumo financeiro com KPIs, pizza por categoria e tend√™ncia de gastos." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- seus estilos -->
  <link rel="stylesheet" href="/css/styles.css" />
  <link rel="stylesheet" href="/css/dashboard.css" />
  <!-- novo: estilos do modal de configura√ß√µes/tema -->
  <link rel="stylesheet" href="/css/settings.css" />

  <!-- Chart.js (gr√°ficos) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body class="dash-body">
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sb-brand">
      <span class="sb-logo">FC</span>
      <span class="sb-name">FinControl</span>
    </div>
    <nav class="sb-nav">
      <a class="sb-link active" href="dashboard.html">üè† Dashboard</a>
      <a class="sb-link" href="transacoes.html">üí≥ Transa√ß√µes</a>
      <a class="sb-link" href="categorias.html">üè∑Ô∏è Or√ßamentos</a>
      <a class="sb-link" href="categorias.html#goals">üéØ Goals</a>
      <a class="sb-link" href="relatorios.html">üìë Relat√≥rios</a>
    </nav>
    <div class="sb-foot">
      <!-- alterado: abre modal ao inv√©s de navegar -->
      <a class="sb-link" href="#" id="openSettings">‚öôÔ∏è Configura√ß√µes</a>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="dash-main">
    <!-- Topbar -->
    <header class="dash-top">
      <h1>Dashboard</h1>

      <div class="userbox" id="userbox">
        <div class="avatar" id="avatar" aria-hidden="true">?</div>
        <div class="user-meta">
          <span class="user-name" id="userNome">...</span>
          <span class="user-email" id="userEmail">...</span>
        </div>
        <button class="user-menu-btn" id="userMenuBtn" aria-label="Abrir menu do usu√°rio">‚ñæ</button>

        <div class="user-menu" id="userMenu" role="menu" hidden>
          <!-- alterado: gatilho do modal tamb√©m aqui -->
          <a role="menuitem" href="#" id="openSettingsTop">Configura√ß√µes</a>
          <button role="menuitem" id="logoutBtn" class="logout">Sair</button>
        </div>
      </div>
    </header>

    <!-- KPIs -->
    <section class="kpi-row">
      <article class="kpi-card">
        <span class="kpi-label">Receita</span>
        <span class="kpi-value" id="kpi-income">$0</span>
      </article>
      <article class="kpi-card">
        <span class="kpi-label">Despesas</span>
        <span class="kpi-value" id="kpi-expenses">$0</span>
      </article>
      <article class="kpi-card">
        <span class="kpi-label">Saldo Atual</span>
        <span class="kpi-value" id="kpi-balance">$0</span>
      </article>
    </section>

    <!-- Vis√£o de Gastos -->
    <section class="section-box">
      <h2>Vis√£o de Gastos</h2>

      <div class="overview-grid">
        <!-- Pizza por categoria -->
        <article class="panel">
          <div class="panel-head">
            <div>
              <h3>Gasto por Categoria</h3>
              <p class="muted" id="cat-note">+0% Este M√™s</p>
            </div>
            <div class="panel-total">
              <span class="total-label">Total</span>
              <span class="total-value" id="cat-total">$0</span>
            </div>
          </div>
          <div class="panel-body">
            <div class="chart-wrap">
              <canvas id="pieByCategoria" aria-label="Gasto por Categoria"></canvas>
            </div>
            <ul class="legend" id="legend-cats"><!-- preenchido via JS --></ul>
          </div>
        </article>

        <!-- Linha: tend√™ncia -->
        <article class="panel">
          <div class="panel-head">
            <div>
              <h3>Tend√™ncia de Gastos</h3>
              <p class="muted" id="trend-note">-0% √öltimos 6 meses</p>
            </div>
            <div class="panel-total">
              <span class="total-label">Este M√™s</span>
              <span class="total-value" id="trend-total">$0</span>
            </div>
          </div>
          <div class="panel-body">
            <div class="chart-wrap">
              <canvas id="lineTrend" aria-label="Tend√™ncia de Gastos"></canvas>
            </div>
          </div>
        </article>
      </div>
    </section>
  </main>

  <!-- ========== MODAL DE CONFIGURA√á√ïES (no pr√≥prio dashboard) ========== -->
  <div id="settingsModal" class="set-modal" aria-hidden="true">
    <div class="set-backdrop" data-close="1"></div>

    <div class="set-card" role="dialog" aria-modal="true" aria-labelledby="setTitle">
      <header class="set-head">
        <h3 id="setTitle">Configura√ß√µes</h3>
        <button class="icon close" data-close="1" aria-label="Fechar">‚úï</button>
      </header>

      <section class="set-body">
        <!-- Tema -->
        <div class="set-block">
          <h4>Tema</h4>
          <div class="row between">
            <span>Tema escuro</span>
            <label class="switch">
              <input id="prefTheme" type="checkbox" />
              <span></span>
            </label>
          </div>
          <p class="muted">Altera todo o visual da interface para escuro/claro.</p>
        </div>

        <!-- Cor de destaque -->
        <div class="set-block">
          <h4>Cor dos Gr√°ficos</h4>
          <div class="row wrap gap">
            <button class="swatch" data-accent="#19d06a" style="--c:#19d06a" title="Verde"></button>
            <button class="swatch" data-accent="#0ea5e9" style="--c:#0ea5e9" title="Azul"></button>
            <button class="swatch" data-accent="#a855f7" style="--c:#a855f7" title="Roxo"></button>
            <button class="swatch" data-accent="#f59e0b" style="--c:#f59e0b" title="Laranja"></button>
            <button class="swatch" data-accent="#ef4444" style="--c:#ef4444" title="Vermelho"></button>
            <label class="custom-color">
              <input id="prefAccent" type="color" value="#19d06a" />
              <span>Personalizar</span>
            </label>
          </div>
          <p class="muted">Define a cor principal de linhas/barras e bot√µes de a√ß√£o.</p>
        </div>

        <!-- Gr√°ficos: suaviza√ß√£o -->
        <div class="set-block">
          <h4>Estilo dos Gr√°ficos</h4>
          <div class="row between">
            <span>Suavizar linhas (spline)</span>
            <label class="switch">
              <input id="prefTension" type="checkbox" />
              <span></span>
            </label>
          </div>
        </div>
      </section>

      <footer class="set-foot">
        <button id="btnResetPrefs" class="btn ghost">Restaurar Padr√£o</button>
        <div class="grow"></div>
        <button class="btn ghost" data-close="1">Cancelar</button>
        <button id="btnSavePrefs" class="btn primary">Salvar</button>
      </footer>
    </div>
  </div>
  <!-- ================================================================== -->

  <!-- seus scripts -->
  <script src="/js/dashboard.js"></script>
  <!-- novo: aplica tema/cores e abre/fecha modal -->
  <script src="/js/settings.js" defer></script>
</body>
</html>
